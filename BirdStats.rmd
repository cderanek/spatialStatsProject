---
title: "Bird_Project"
author: "Alicia Pentico"
date: "April 21, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(rgdal) # Provides links to the 'Geospatial' Data Abstraction Library ('GDAL') and access to projection/transformation operations from the 'PROJ.4' library.
library(sp) # Classes and methods for spatial data
library(spdep) # for modeling of spatial dependencies
library(maptools) # provides various mapping functions
library(RANN) # for nearest neighbor calculations
```

### READING IN DATA
```{r}
captureBirds<-read.csv("balbina_understory_birds_captures.csv", header = TRUE)
birdInfo<-read.csv("balbina_understory_birds_taxonomy_traits.csv", header = TRUE)
environment<-read.csv("balbina_environmental_variables.csv", header = TRUE)
str(captureBirds)
```

###DATA FORMATTING
```{r}
#str(captureBirds)
noRecaptures <- subset(captureBirds, captureBirds$new.individual == "yes")

perLocation<- as.data.frame(table(noRecaptures$site))
perLocation$longitude<- environment$longitude.WGS84
perLocation$latitude<- environment$latitude.WGS84
perLocation$coverage<- environment$forest.cover.200

names(perLocation)<- c("site", "abundance", "longitude", "latitude","coverage")
str(perLocation)

# create vectors to hold species richness and names to later add as cols to perLocation
speciesRichnessBySite=vector('integer',length=length(perLocation$site))
speciesNamesBySite=vector('list',length=length(perLocation$site))

# get number of species at each site, list of species at each site
# TODO FORMAT SUCH THAT WE MAKE READY FOR SPEC ACCUM - CARISSA TASK
for (i in 1:length(perLocation$site)){
  siteName = perLocation$site[i]
  
  # operations to get T/F list of species at site
  set<-subset(noRecaptures, site == siteName)
  byLocation <- as.data.frame(table(set$species))
  speciesFoundatSite = (byLocation$Freq != 0)
  
  # add speciesRichness to vector
  speciesRichnessBySite[i] = sum(speciesFoundatSite)
  speciesNamesBySite[i] = list(as.character(byLocation$Var1[speciesFoundatSite]))
}

# add species richness and names to perLocation
perLocation$speciesRichness<- speciesRichnessBySite
perLocation$speciesNamesL<- speciesNamesBySite
```



###KRIGING ABUNDANCE, ETC MAPS - TODO ALICIA
```{r}

```


###EXAMPLE FOR SCPEC ACCUM
```{r}
library(vegan)
#data("BCI")
# learned that for specaccum function, we pass in dataframe whose cols are species names and rows are incidents, each cell has the count of species@thatincidence

```


###DIET BY LOCATION - MAKE KRIGING BY DIETS, THINK OF SOME ANALYSIS USING MORE DETAILED DIET NUMBERS
```{r}


```
